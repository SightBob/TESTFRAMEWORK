<!DOCTYPE html>

<html lang="en"
      class="light-style layout-menu-fixed layout-compact"
      dir="ltr"
      data-theme="theme-default"
      data-assets-path="../../assets/"
      data-template="horizontal-menu-template">
<head>
    <meta charset="utf-8" />
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />

    <style>
        @@import url('https://fonts.googleapis.com/css2?family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Noto+Sans+Thai:wght@100..900&family=Noto+Sans:ital,wght@0,100..900;1,100..900&display=swap');

        * {
        font-family: "Kanit", sans-serif;
        }
    </style>

    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preload" href="@Url.Content("~/Content/bootstrap.min.css")" as="style">


    <title>Dashboard - Analytics | Materialize - Material Design HTML Admin Template</title>

    <meta name="description" content="" />

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="~/Content/bootstrap.min.css" />

    <!-- (1) โหลด CSS ของ Select2 -->
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />

    <!-- DataTables CSS -->
    <link href="https://cdn.datatables.net/1.13.8/css/jquery.dataTables.min.css" rel="stylesheet">

    <!-- DataTables JS -->
    <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>

    <!-- CSS CDN -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.8/css/dataTables.bootstrap5.min.css">

    <!-- JS CDN -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.8/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.8/js/dataTables.bootstrap5.min.js"></script>

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="~/Content/assets/img/favicon/favicon.ico" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&ampdisplay=swap"
          rel="stylesheet" />

    <!-- Icons -->
    <link rel="stylesheet" href="~/Content/assets/vendor/fonts/materialdesignicons.css" />
    <link rel="stylesheet" href="~/Content/assets/vendor/fonts/flag-icons.css" />

    <!-- Menu waves for no-customizer fix -->
    <link rel="stylesheet" href="~/Content/assets/vendor/libs/node-waves/node-waves.css" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="~/Content/assets/vendor/css/rtl/core.css" />
    <link rel="stylesheet" href="~/Content/assets/vendor/css/rtl/theme-default.css" />
    <link rel="stylesheet" href="~/Content/assets/css/demo.css" />

    <!-- Vendors CSS -->
    <link rel="stylesheet" href="~/Content/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
    <link rel="stylesheet" href="~/Content/assets/vendor/libs/typeahead-js/typeahead.css" />
    <link rel="stylesheet" href="~/Content/assets/vendor/libs/apex-charts/apex-charts.css" />
    <link rel="stylesheet" href="~/Content/assets/vendor/libs/swiper/swiper.css" />

    <!-- Page CSS -->
    <link rel="stylesheet" href="~/Content/assets/vendor/css/pages/cards-statistics.css" />
    <link rel="stylesheet" href="~/Content/assets/vendor/css/pages/cards-analytics.css" />

    <!-- Helpers -->
    <script src="~/Content/assets/vendor/js/helpers.js"></script>
    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Template customizer: To hide customizer set displayCustomizer value false in config.js.  -->
    <script src="~/Content/assets/vendor/js/template-customizer.js"></script>
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="~/Content/assets/js/config.js"></script>

    @RenderSection("styles", required: false)

    <style>
        .container-custom {
            max-width: 95%;
        }



        .table tbody tr:hover {
            background-color: #f8f9fa;
        }

        .btn-custom {
            padding: 0.5rem 1.5rem;
            font-size: 1rem;
            border-radius: 30px;
        }

        .dataTables_filter input {
            border-radius: 20px;
            padding: 0.5rem;
        }

        .table td {
            vertical-align: middle;
        }

        .table .btn {
            padding: 0.25rem 0.75rem;
            font-size: 0.875rem;
        }

        .project-name-column {
            min-width: 300px !important;
            max-width: 600px;
            word-wrap: break-word;
            white-space: normal;
        }

        .form-control.form-control-sm {
            border-radius: 20px !important;
            margin-bottom: 1rem;
        }

        .dataTables_wrapper .dataTables_paginate .paginate_button:hover {
            background: none !important;
            border: none !important;
        }

        .table thead tr:first-child th {
            background-color: #F26522 !important;
            color: #fff;
        }

        .menu-horizontal .menu-inner > .menu-item .menu-sub {
            overflow: hidden !important;
            padding: 0px !important;
        }

        a {
            text-decoration: none !important;
        }

        .menu-sub {
            opacity: 0 !important;
            visibility: hidden !important;
            transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out !important;
        }

        .menu-item:hover > .menu-sub {
            opacity: 1 !important;
            visibility: visible !important;
        }

        .menu-sub:hover {
            opacity: 1 !important;
            visibility: visible !important;
        }

        h3 {
            margin-bottom: 0px !important;
        }
    </style>

</head>

<body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-navbar-full layout-horizontal layout-without-menu">
        <div class="layout-container">
            <!-- Navbar -->

            <nav class="layout-navbar navbar navbar-expand-xl align-items-center bg-navbar-theme" id="layout-navbar">
                <div class="container-xxl">
                    <div class="navbar-brand app-brand demo d-none d-xl-flex py-0 me-4">
                        <a href="index.html" class="app-brand-link gap-2">
                            <img style="width: 60px" src="~/Content/assets/img/SUTHLOGO-01.png" />
                            <span class="app-brand-text demo menu-text fw-bold">ResearchBase</span>
                        </a>

                        <a href="javascript:void(0);" class="layout-menu-toggle menu-link text-large ms-auto d-xl-none">
                            <i class="mdi mdi-close align-middle"></i>
                        </a>
                    </div>

                    <div class="layout-menu-toggle navbar-nav align-items-xl-center me-3 me-xl-0 d-xl-none">
                        <a class="nav-item nav-link px-0 me-xl-4" href="javascript:void(0)">
                            <i class="mdi mdi-menu mdi-24px"></i>
                        </a>
                    </div>

                    <div class="navbar-nav-right d-flex align-items-center" id="navbar-collapse">
                        <ul class="navbar-nav flex-row align-items-center ms-auto">



                            <!-- User Dropdown -->
                            <li class="nav-item navbar-dropdown dropdown-user dropdown">
                                <a class="nav-link dropdown-toggle hide-arrow" href="javascript:void(0);" data-bs-toggle="dropdown">
                                    <div class="avatar avatar-online">
                                        <img src="https://demos.pixinvent.com/materialize-html-admin-template/assets/img/avatars/1.png" class="w-px-40 h-auto rounded-circle" />
                                    </div>
                                </a>
                                <ul class="dropdown-menu dropdown-menu-end">
                                    <li>
                                        <a class="dropdown-item" href="pages-account-settings-account.html">
                                            <div class="d-flex">
                                                <div class="flex-shrink-0 me-3">
                                                    <div class="avatar avatar-online">
                                                        <img src="https://demos.pixinvent.com/materialize-html-admin-template/assets/img/avatars/1.png" class="w-px-40 h-auto rounded-circle" />
                                                    </div>
                                                </div>
                                                <div class="flex-grow-1">
                                                    <span class="fw-medium d-block">
                                                        @{
                                                            var userName = Session["Username"]?.ToString();
                                                            if (string.IsNullOrEmpty(userName))
                                                            {
                                                                @:No Username
                                                            }
                                                            else
                                                            {
                                                                @userName
                                                            }
                                                        }
                                                    </span>
                                                    <small class="text-muted">
                                                        @{
                                                            var userRole = Session["Role"]?.ToString();
                                                            if (string.IsNullOrEmpty(userRole))
                                                            {
                                                                @:No Role Assigned
                                                            }
                                                            else
                                                            {
                                                                @userRole
                                                            }
                                                        }
                                                    </small>
                                                </div>
                                            </div>
                                        </a>
                                    </li>
                                    <li>
                                        <div class="dropdown-divider"></div>
                                    </li>
                                    <!-- แสดงเมนู "จัดการผู้ใช้" เฉพาะ Admin -->
                                    @{
                                        var role = Session["Role"]?.ToString();
                                        if (role == "Admin")
                                        {
                                            <li>
                                                <a class="dropdown-item" href="@Url.Action("Index", "ManageUser")">
                                                    <i class="mdi mdi-account-outline me-2"></i>
                                                    <span class="align-middle">จัดการผู้ใช้</span>
                                                </a>
                                            </li>
                                            <li>
                                                <div class="dropdown-divider"></div>
                                            </li>
                                        }
                                    }
                                    <li>
                                        <a class="dropdown-item" href="@Url.Action("Logout", "Auth")">
                                            <i class="mdi mdi-logout me-2"></i>
                                            <span class="align-middle">Log Out</span>
                                        </a>
                                    </li>
                                </ul>
                            </li>

                            <!--/ User -->
                        </ul>
                    </div>

                    <!-- Search Small Screens -->
                    <div class="navbar-search-wrapper search-input-wrapper container-xxl d-none">
                        <input type="text"
                               class="form-control search-input border-0"
                               placeholder="Search..."
                               aria-label="Search..." />
                        <i class="mdi mdi-close search-toggler cursor-pointer"></i>
                    </div>
                </div>
            </nav>

            <!-- / Navbar -->
            <!-- Layout container -->
            <div class="layout-page">
                <!-- Content wrapper -->
                <div class="w-100">
                    <!-- Menu -->
                    <aside id="layout-menu" class="layout-menu-horizontal menu-horizontal menu bg-menu-theme flex-grow-0">
                        <div class="container-xxl d-flex h-100">
                            <ul class="menu-inner">
                                <!-- Dashboards -->
                                <li class="menu-item">
                                    <a href="@Url.Action("Index", "DashBoard")" class="menu-link">
                                        <div data-i18n="Dashboard">Dashboard</div>
                                    </a>
                                </li>

                                <!-- Research -->
                                <li class="menu-item">
                                    <a href="@Url.Action("Index", "Research")" class="menu-link">
                                        <div data-i18n="ข้อมูลงานวิจัย">ข้อมูลงานวิจัย</div>
                                    </a>
                                </li>

                                <li class="menu-item ">
                                    <a href="javascript:void(0)" class="menu-link menu-toggle">
                                        <div data-i18n="ข้อมูลผู้วิจัย">ข้อมูลผู้วิจัย</div>
                                    </a>
                                    <ul class="menu-sub">
                                        <li class="menu-item">
                                            <a href="@Url.Action("Index", "Researcher")" class="menu-link">
                                                <div data-i18n="บุคคลภายใน">บุคคลภายใน</div>
                                            </a>
                                        </li>
                                        <li class="menu-item">
                                            <a href="@Url.Action("ExternalResearchers", "Researcher")" class="menu-link">
                                                <div data-i18n="บุคคลภายนอก">บุคคลภายนอก</div>
                                            </a>
                                        </li>
                                    </ul>
                                </li>

                                <!-- Basic Information -->
                                <li class="menu-item">
                                    <a href="javascript:void(0)" class="menu-link menu-toggle">
                                        <div data-i18n="ข้อมูลพื้นฐาน">ข้อมูลพื้นฐาน</div>
                                    </a>
                                    <ul class="menu-sub overflow-hidden">
                                        <li class="menu-item">
                                            <a href="@Url.Action("Index", "WorkGroups")" class="menu-link">
                                                <div data-i18n="กลุ่มงาน">กลุ่มงาน</div>
                                            </a>
                                        </li>
                                        <li class="menu-item">
                                            <a href="@Url.Action("Index", "Chart")" class="menu-link">
                                                <div data-i18n="ฝ่าย">ฝ่าย</div>
                                            </a>
                                        </li>
                                        <li class="menu-item">
                                            <a href="@Url.Action("Index", "Division")" class="menu-link">
                                                <div data-i18n="แผนก">แผนก</div>
                                            </a>
                                        </li>
                                    </ul>
                                </li>
                            </ul>
                        </div>
                    </aside>


                    <!-- / Menu -->
                    <!-- Content wrapper -->
                    @RenderBody();
                    <!--/ Content wrapper -->
                </div>

                <!--/ Layout container -->
            </div>
        </div>
    </div>

    <!-- Overlay -->
    <div class="layout-overlay layout-menu-toggle"></div>

    <!-- Drag Target Area To SlideIn Menu On Small Screens -->
    <div class="drag-target"></div>

    <!--/ Layout wrapper -->
    <!-- _insertStylesheet JS -->
    <!-- build:js assets/vendor/js/core.js -->
    <script src="~/Content/assets/vendor/libs/jquery/jquery.js"></script>
    <script src="~/Content/assets/vendor/libs/popper/popper.js"></script>
    <script src="~/Content/assets/vendor/js/bootstrap.js"></script>
    <script src="~/Content/assets/vendor/libs/node-waves/node-waves.js"></script>
    <script src="~/Content/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>
    <script src="~/Content/assets/vendor/libs/hammer/hammer.js"></script>
    <script src="~/Content/assets/vendor/libs/i18n/i18n.js"></script>
    <script src="~/Content/assets/vendor/libs/typeahead-js/typeahead.js"></script>
    <script src="~/Content/assets/vendor/js/menu.js"></script>
    <!-- endbuild -->
    <!-- Vendors JS -->
    <script src="~/Content/assets/vendor/libs/apex-charts/apexcharts.js"></script>
    <script src="~/Content/assets/vendor/libs/swiper/swiper.js"></script>

    <!-- Main JS -->
    <script src="~/Content/assets/js/main.js"></script>

    <!-- Page JS -->
    <script src="~/Content/assets/js/dashboards-analytics.js"></script>


    <!-- jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Bootstrap Bundle (js) -->
    <script src="~/Scripts/bootstrap.bundle.min.js"></script>

    <!-- Bootstrap-Select JS -->
    <script src="~/Scripts/bootstrap-select.min.js"></script>

    <!-- โหลด jQuery ก่อนเสมอ -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- โหลด JS ของ Select2 -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

    @RenderSection("scripts", required: false)

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // Get current path and clean it
            const currentPath = window.location.pathname.replace(/\/$/, "");

            // Reset all menu items first
            document.querySelectorAll(".menu-item a").forEach(link => {
                link.classList.remove("active");
                link.style.background = "";
                link.style.color = "";
            });

            // Find matching links and activate them
            document.querySelectorAll(".menu-item a").forEach(link => {
                try {
                    // Skip javascript:void(0) links during comparison
                    if (link.href.includes("javascript:void(0)")) return;

                    const linkPath = new URL(link.href).pathname.replace(/\/$/, "");

                    if (linkPath === currentPath) {
                        // Highlight the current link

                        link.style.background = "#F26522";
                        link.style.color = "#FFFFFF";

                        // If inside a submenu, expand parent menu
                        const parentSubMenu = link.closest(".menu-sub");
                        if (parentSubMenu) {
                            // Show the submenu
                            a

                            // Highlight parent menu item
                            const parentMenuItem = parentSubMenu.closest(".menu-item");
                            if (parentMenuItem) {
                                const parentMenuLink = parentMenuItem.querySelector("a.menu-toggle");
                                if (parentMenuLink) {
                                    parentMenuLink.style.color = "#F26522";
                                }
                            }
                        }
                    }
                } catch (e) {
                    console.warn("Error processing menu link:", e);
                }
            });

        });

        // Lazy load images
        document.addEventListener("DOMContentLoaded", function () {
            const images = document.querySelectorAll('img[data-src]');
            images.forEach(img => {
                img.src = img.dataset.src;
            });
        });
    </script>




</body>
</html>
